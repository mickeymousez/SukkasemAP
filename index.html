<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏¥‡∏î‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏´‡∏≠‡∏û‡∏±‡∏Å</title>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: 'Kanit', sans-serif;
      background: #1e2a36;
      color: white;
      padding: 40px;
    }
    .container {
      max-width: 900px;
      margin: auto;
    }
    .form-grid {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }
    .form-group {
      flex: 1;
      background: #2c3e50;
      padding: 20px;
      border-radius: 12px;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    input {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid #455a64;
      background: #34495e;
      color: white;
    }
    .note {
      font-size: 13px;
      color: #ccc;
    }
    .inline-grid {
      display: flex;
      gap: 10px;
    }
    .inline-grid > div {
      flex: 1;
    }
    .section-box {
      margin-top: 20px;
      padding: 15px;
      background: #1c2833;
      border-radius: 10px;
    }
    .section-title {
      font-weight: bold;
      margin-bottom: 10px;
      color: #00bcd4;
    }
    button {
      margin-top: 20px;
      width: 100%;
      padding: 12px;
      font-size: 16px;
      background: #00bcd4;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    #result {
      margin-top: 30px;
      background: #263645;
      padding: 20px;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>üíº ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏¥‡∏î‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏´‡∏≠‡∏û‡∏±‡∏Å</h2>

    <form class="form-grid" action="https://script.google.com/macros/s/AKfycbwDRWYEk4iR_A6rsfOQg830j7mGLZaAj1KyAS-sLl8MPOgXgKSyjrdgbPuJ-qbq4W9U/exec" method="POST" target="_blank">
      <div class="form-group">
        <label>‡∏´‡πâ‡∏≠‡∏á:</label>
        <input name="room" required placeholder="‡πÄ‡∏ä‡πà‡∏ô 101">

        <label>‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤:</label>
        <input name="tenant" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠">

        <label>‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á (‡∏ö‡∏≤‡∏ó):</label>
        <input type="number" name="rent">

        <label>‡∏Ñ‡πà‡∏≤‡∏à‡∏≠‡∏î‡∏£‡∏ñ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ):</label>
        <input type="number" name="parking" placeholder="‡πÉ‡∏™‡πà 0 ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ">
        <small class="note">* ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</small>

        <div class="section-box">
          <div class="section-title">üîå ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤</div>
          <div class="inline-grid">
            <div>
              <label>‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå (‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô):</label>
              <input type="number" name="elecPrev" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1250">
            </div>
            <div>
              <label>‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô):</label>
              <input type="number" name="elecCurr" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1310">
            </div>
          </div>
          <label>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏ö‡∏≤‡∏ó):</label>
          <input type="number" name="elecRate" value="8">
        </div>
      </div>

      <div class="form-group">
        <div class="section-box">
          <div class="section-title">üöø ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤</div>
          <div class="inline-grid">
            <div>
              <label>‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå (‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô):</label>
              <input type="number" name="waterPrev" placeholder="‡πÄ‡∏ä‡πà‡∏ô 320">
            </div>
            <div>
              <label>‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô):</label>
              <input type="number" name="waterCurr" placeholder="‡πÄ‡∏ä‡πà‡∏ô 330">
            </div>
          </div>
          <label>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏ö‡∏≤‡∏ó):</label>
          <input type="number" name="waterRate" value="18">
        </div>

        <button type="button" onclick="calculate()">üìä ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤</button>
        <button type="submit">üì§ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheet</button>
      </div>
    </form>

    <div id="result"></div>
  </div>

<script>
  function calculate() {
    const rent = parseFloat(document.querySelector('[name="rent"]').value || 0);
    const parking = parseFloat(document.querySelector('[name="parking"]').value || 0);

    const elecUsed = parseFloat(document.querySelector('[name="elecCurr"]').value || 0) - parseFloat(document.querySelector('[name="elecPrev"]').value || 0);
    const elecRate = parseFloat(document.querySelector('[name="elecRate"]').value || 0);
    const elecTotal = elecUsed >= 0 ? elecUsed * elecRate : 0;

    const waterUsed = parseFloat(document.querySelector('[name="waterCurr"]').value || 0) - parseFloat(document.querySelector('[name="waterPrev"]').value || 0);
    const waterRate = parseFloat(document.querySelector('[name="waterRate"]').value || 0);
    const waterTotal = waterUsed >= 0 ? waterUsed * waterRate : 0;

    const total = rent + parking + elecTotal + waterTotal;

    document.getElementById('result').innerHTML = `
      <b>üìã ‡πÉ‡∏ö‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</b><br><br>
      ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á: ${rent.toLocaleString()} ‡∏ö‡∏≤‡∏ó<br>
      ${parking > 0 ? `‡∏Ñ‡πà‡∏≤‡∏à‡∏≠‡∏î‡∏£‡∏ñ: ${parking.toLocaleString()} ‡∏ö‡∏≤‡∏ó<br>` : ""}
      ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü (${elecUsed} ‡∏´‡∏ô‡πà‡∏ß‡∏¢): ${elecTotal.toLocaleString()} ‡∏ö‡∏≤‡∏ó<br>
      ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥ (${waterUsed} ‡∏´‡∏ô‡πà‡∏ß‡∏¢): ${waterTotal.toLocaleString()} ‡∏ö‡∏≤‡∏ó<br><br>
      <b>üí∞ ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô: ${total.toLocaleString()} ‡∏ö‡∏≤‡∏ó</b>
    `;
  }
</script>

</body>
</html>
