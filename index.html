<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏¥‡∏î‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏´‡∏≠‡∏û‡∏±‡∏Å</title>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Kanit', sans-serif;
      background: #1e2a36;
      color: white;
      padding: 40px;
    }
    .container {
      max-width: 900px;
      margin: auto;
    }
    .form-grid {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }
    .form-group {
      flex: 1;
      background: #2c3e50;
      padding: 20px;
      border-radius: 12px;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    input {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid #455a64;
      background: #34495e;
      color: white;
    }
    .note {
      font-size: 13px;
      color: #ccc;
    }
    .inline-grid {
      display: flex;
      gap: 10px;
    }
    .inline-grid > div {
      flex: 1;
    }
    .section-box {
      margin-top: 20px;
      padding: 15px;
      background: #1c2833;
      border-radius: 10px;
    }
    .section-title {
      font-weight: bold;
      margin-bottom: 10px;
      color: #00bcd4;
    }
    button {
      margin-top: 20px;
      width: 100%;
      padding: 12px;
      font-size: 16px;
      background: #00bcd4;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    #result {
      margin-top: 30px;
      background: #263645;
      padding: 20px;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>üíº ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏¥‡∏î‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏´‡∏≠‡∏û‡∏±‡∏Å</h2>

    <div class="form-grid">
      <div class="form-group">
        <label>‡∏´‡πâ‡∏≠‡∏á:</label>
        <input id="room" placeholder="‡πÄ‡∏ä‡πà‡∏ô 101">

        <label>‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤:</label>
        <input id="tenant" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠">

        <label>‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á (‡∏ö‡∏≤‡∏ó):</label>
        <input type="number" id="rent">

        <label>‡∏Ñ‡πà‡∏≤‡∏à‡∏≠‡∏î‡∏£‡∏ñ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ):</label>
        <input type="number" id="parking" placeholder="‡πÉ‡∏™‡πà 0 ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ">
        <small class="note">* ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</small>

        <div class="section-box">
          <div class="section-title">üîå ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤</div>
          <div class="inline-grid">
            <div>
              <label>‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå (‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô):</label>
              <input type="number" id="elecPrev" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1250">
            </div>
            <div>
              <label>‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô):</label>
              <input type="number" id="elecCurr" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1310">
            </div>
          </div>
          <label>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏ö‡∏≤‡∏ó):</label>
          <input type="number" id="elecRate" value="8">
        </div>
      </div>

      <div class="form-group">
        <div class="section-box">
          <div class="section-title">üöø ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤</div>
          <div class="inline-grid">
            <div>
              <label>‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå (‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô):</label>
              <input type="number" id="waterPrev" placeholder="‡πÄ‡∏ä‡πà‡∏ô 320">
            </div>
            <div>
              <label>‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô):</label>
              <input type="number" id="waterCurr" placeholder="‡πÄ‡∏ä‡πà‡∏ô 330">
            </div>
          </div>
          <label>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢ (‡∏ö‡∏≤‡∏ó):</label>
          <input type="number" id="waterRate" value="18">
        </div>

        <button onclick="calculate()">üìä ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤</button>
        <button onclick="submitToSheet()">üì§ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheet</button>
      </div>
    </div>

    <div id="result"></div>
  </div>

  <script>
    function calculate() {
      const rent = parseFloat(document.getElementById('rent').value || 0);
      const parking = parseFloat(document.getElementById('parking').value || 0);

      const elecUsed = parseFloat(document.getElementById('elecCurr').value || 0) - parseFloat(document.getElementById('elecPrev').value || 0);
      const elecRate = parseFloat(document.getElementById('elecRate').value || 0);
      const elecTotal = elecUsed >= 0 ? elecUsed * elecRate : 0;

      const waterUsed = parseFloat(document.getElementById('waterCurr').value || 0) - parseFloat(document.getElementById('waterPrev').value || 0);
      const waterRate = parseFloat(document.getElementById('waterRate').value || 0);
      const waterTotal = waterUsed >= 0 ? waterUsed * waterRate : 0;

      const total = rent + parking + elecTotal + waterTotal;

      document.getElementById('result').innerHTML = `
        <b>üìã ‡πÉ‡∏ö‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</b><br><br>
        ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á: ${rent.toLocaleString()} ‡∏ö‡∏≤‡∏ó<br>
        ${parking > 0 ? `‡∏Ñ‡πà‡∏≤‡∏à‡∏≠‡∏î‡∏£‡∏ñ: ${parking.toLocaleString()} ‡∏ö‡∏≤‡∏ó<br>` : ""}
        ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü (${elecUsed} ‡∏´‡∏ô‡πà‡∏ß‡∏¢): ${elecTotal.toLocaleString()} ‡∏ö‡∏≤‡∏ó<br>
        ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥ (${waterUsed} ‡∏´‡∏ô‡πà‡∏ß‡∏¢): ${waterTotal.toLocaleString()} ‡∏ö‡∏≤‡∏ó<br><br>
        <b>üí∞ ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô: ${total.toLocaleString()} ‡∏ö‡∏≤‡∏ó</b>
      `;
    }

    function submitToSheet() {
      const data = {
        room: document.getElementById('room').value,
        tenant: document.getElementById('tenant').value,
        rent: parseFloat(document.getElementById('rent').value || 0),
        parking: parseFloat(document.getElementById('parking').value || 0),
        elecUsed: parseFloat(document.getElementById('elecCurr').value || 0) - parseFloat(document.getElementById('elecPrev').value || 0),
        waterUsed: parseFloat(document.getElementById('waterCurr').value || 0) - parseFloat(document.getElementById('waterPrev').value || 0),
        elecTotal: (parseFloat(document.getElementById('elecCurr').value || 0) - parseFloat(document.getElementById('elecPrev').value || 0)) * parseFloat(document.getElementById('elecRate').value || 0),
        waterTotal: (parseFloat(document.getElementById('waterCurr').value || 0) - parseFloat(document.getElementById('waterPrev').value || 0)) * parseFloat(document.getElementById('waterRate').value || 0)
      };
      data.total = data.rent + data.parking + data.elecTotal + data.waterTotal;

      if (!data.room || !data.tenant) {
        alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");
        return;
      }

      const scriptURL = "https://script.google.com/macros/s/AKfycbwDRWYEk4iR_A6rsfOQg830j7mGLZaAj1KyAS-sLl8MPOgXgKSyjrdgbPuJ-qbq4W9U/exec";
      fetch(scriptURL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      }).then(res => res.text()).then(res => {
        alert("‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
      }).catch(err => {
        alert("‚ùå ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß");
        console.error(err);
      });
    }
  </script>
</body>
</html>
